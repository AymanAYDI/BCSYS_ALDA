OBJECT Page 673 Job Queue Entry Card
{
  OBJECT-PROPERTIES
  {
    Date=03/07/18;
    Time=17:19:18;
    Modified=Yes;
    Version List=NAVW18.00,AC1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Job Queue Entry Card;
               FRA=Fiche Çcriture file d'attente des travaux];
    SourceTable=Table472;
    DataCaptionFields=Object Type to Run,Object Caption to Run;
    PageType=Card;
    OnAfterGetRecord=BEGIN
                       // AC1.00
                       GetEDIDescription();
                     END;

    OnNewRecord=BEGIN
                  ID := CREATEGUID;
                  Status := Status::"On Hold";
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 49      ;1   ;ActionGroup;
                      CaptionML=[ENU=Job &Queue;
                                 FRA=&File d'attente des travaux];
                      Image=CheckList }
      { 51      ;2   ;Action    ;
                      CaptionML=[ENU=Set Status to Ready;
                                 FRA=DÇfinir le statut sur Pràt];
                      Promoted=Yes;
                      Image=ResetStatus;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetStatus(Status::Ready);
                               END;
                                }
      { 52      ;2   ;Action    ;
                      CaptionML=[ENU=Set On Hold;
                                 FRA=Mettre en attente];
                      Promoted=Yes;
                      Image=Pause;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetStatus(Status::"On Hold");
                               END;
                                }
      { 1180250001;2 ;Separator  }
      { 1180250002;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Run;
                                 FRA=Lancer];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExecuteBatch;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // AC1.00
                                 RunOnPush();
                               END;
                                }
      { 1180250004;2 ;Separator  }
      { 1180250003;2 ;Action    ;
                      CaptionML=[ENU=E.D.I.;
                                 FRA=E.D.I.];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ImportExport;
                      OnAction=BEGIN
                                 // AC1.00
                                 EDIOnPush();
                               END;
                                }
      { 7       ;2   ;Action    ;
                      CaptionML=[ENU=Show Error;
                                 FRA=Afficher erreur];
                      Promoted=Yes;
                      Image=Error;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowErrorMessage;
                               END;
                                }
      { 13      ;2   ;Action    ;
                      Name=Restart;
                      CaptionML=[ENU=Restart;
                                 FRA=RedÇmarrer];
                      Promoted=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Restart;
                               END;
                                }
      { 17      ;0   ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 12      ;1   ;ActionGroup;
                      CaptionML=[ENU=Job &Queue;
                                 FRA=&File d'attente des travaux];
                      Image=CheckList }
      { 19      ;2   ;Action    ;
                      Name=LogEntries;
                      CaptionML=[ENU=Log Entries;
                                 FRA=êcritures journal];
                      RunObject=Page 674;
                      RunPageLink=ID=FIELD(ID);
                      Promoted=Yes;
                      Image=Log;
                      PromotedCategory=Process }
      { 15      ;2   ;Action    ;
                      Name=ShowRecord;
                      CaptionML=[ENU=Show Record;
                                 FRA=Afficher enregistrement];
                      Image=ViewDetails;
                      OnAction=BEGIN
                                 LookupRecordToProcess;
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=ReportRequestPage;
                      CaptionML=[ENU=Report Request Page;
                                 FRA=Page requàte Çtat];
                      Promoted=Yes;
                      Enabled="Object Type to Run" = "Object Type to Run"::Report;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 RunReportRequestPage;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           FRA=GÇnÇral] }

    { 2   ;2   ;Field     ;
                SourceExpr="Object Type to Run" }

    { 4   ;2   ;Field     ;
                SourceExpr="Object ID to Run" }

    { 6   ;2   ;Field     ;
                SourceExpr="Object Caption to Run" }

    { 5   ;2   ;Field     ;
                SourceExpr=Description }

    { 14  ;2   ;Field     ;
                SourceExpr="Parameter String" }

    { 1180250005;2;Field  ;
                CaptionML=[ENU=EDI Description;
                           FRA=DÇsignation EDI];
                SourceExpr=EDIDescription }

    { 3   ;2   ;Field     ;
                SourceExpr="Job Queue Category Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="User ID" }

    { 9   ;2   ;Field     ;
                SourceExpr="Timeout (sec.)" }

    { 10  ;2   ;Field     ;
                SourceExpr="Maximum No. of Attempts to Run" }

    { 16  ;2   ;Field     ;
                SourceExpr="Last Ready State" }

    { 20  ;2   ;Field     ;
                SourceExpr="Earliest Start Date/Time" }

    { 18  ;2   ;Field     ;
                SourceExpr="Expiration Date/Time" }

    { 22  ;2   ;Field     ;
                SourceExpr=Priority }

    { 11  ;2   ;Field     ;
                SourceExpr="Run in User Session" }

    { 24  ;2   ;Field     ;
                SourceExpr=Status }

    { 21  ;1   ;Group     ;
                CaptionML=[ENU=Report Parameters;
                           FRA=Paramätres Çtat];
                Visible="Object Type to Run" = "Object Type to Run"::Report;
                GroupType=Group }

    { 23  ;2   ;Field     ;
                SourceExpr="Report Request Page Options" }

    { 27  ;2   ;Field     ;
                SourceExpr="Report Output Type" }

    { 25  ;2   ;Field     ;
                SourceExpr="Printer Name" }

    { 1900576001;1;Group  ;
                CaptionML=[ENU=Recurrence;
                           FRA=RÇpÇtition] }

    { 26  ;2   ;Field     ;
                SourceExpr="Recurring Job";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Run on Mondays" }

    { 30  ;2   ;Field     ;
                SourceExpr="Run on Tuesdays" }

    { 32  ;2   ;Field     ;
                SourceExpr="Run on Wednesdays" }

    { 34  ;2   ;Field     ;
                SourceExpr="Run on Thursdays" }

    { 36  ;2   ;Field     ;
                SourceExpr="Run on Fridays" }

    { 38  ;2   ;Field     ;
                SourceExpr="Run on Saturdays" }

    { 40  ;2   ;Field     ;
                SourceExpr="Run on Sundays" }

    { 42  ;2   ;Field     ;
                SourceExpr="Starting Time";
                Editable="Recurring Job" = TRUE }

    { 44  ;2   ;Field     ;
                SourceExpr="Ending Time";
                Editable="Recurring Job" = TRUE }

    { 46  ;2   ;Field     ;
                SourceExpr="No. of Minutes between Runs";
                Editable="Recurring Job" = TRUE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      EDIDescription@1180250001 : Text[50];

    PROCEDURE RunOnPush@1180250001();
    VAR
      JobQueueEntry@1180250001 : Record 472;
    BEGIN
      // AC1.00 BEGIN
      CLEAR(JobQueueEntry);

      JobQueueEntry.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(JobQueueEntry);

      JobQueueEntry.RunJob();
      // AC1.00 END
    END;

    PROCEDURE EDIOnPush@1180250002();
    VAR
      JobQueueEntry@1180250001 : Record 472;
      EDISetup@1180250002 : Record 50000;
      EDICode@1180250003 : Code[10];
    BEGIN
      // AC1.00 BEGIN
      CLEAR(JobQueueEntry);

      JobQueueEntry.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(JobQueueEntry);

      JobQueueEntry.TESTFIELD("Parameter String");
      EDICode := FORMAT("Parameter String");
      EDISetup.GET(EDICode);

      PAGE.RUNMODAL(PAGE::"E.D.I. Setup List",EDISetup);
      // AC1.00 END
    END;

    PROCEDURE GetEDIDescription@1180250003();
    VAR
      EDISetup@1180250001 : Record 50000;
    BEGIN
      // AC1.00 BEGIN
      EDISetup.RESET;
      EDISetup.SETRANGE(Code,COPYSTR("Parameter String",1,MAXSTRLEN(EDISetup.Code)));
      IF EDISetup.FINDFIRST THEN
        EDIDescription := EDISetup.Description
      ELSE
        EDIDescription := '***Pas d''EDI***';
      // AC1.00 END
    END;

    BEGIN
    {
      AC1.00 BDU Ajout Fonction : Run(),ShowEDI;
                       Action : Run...,EDI... + C/AL onPush()
    }
    END.
  }
}

